

# è¿‡æ¡¥é—®é¢˜

## ğŸ§© é—®é¢˜å¼•å…¥

å°æ˜ä¸€å®¶è¿‡æ¡¥ï¼Œå¿…é¡»åœ¨30ç§’å†…è¿‡å»ã€‚ä¸€æ¬¡å¯ä»¥è¿‡ä¸¤äººï¼Œåªæœ‰ä¸€ç›ç¯ç¬¼ã€‚å…±æœ‰äº”äººè¿‡æ¡¥ï¼Œåˆ†åˆ«ç”¨æ—¶ä»¥1ã€3ã€6ã€8ã€12ç§’ã€‚å¦‚ä½•è®©å…¨å®¶å®‰å…¨è¿‡æ¡¥ï¼Ÿ

> 1, 3, 6, 8, 12

é—®ï¼šå¦‚ä½•å®‰æ’è¿‡æ¡¥é¡ºåºï¼Œä½¿å…¨éƒ¨äººéƒ½è¿‡æ¡¥çš„æ€»è€—æ—¶æœ€å°‘ï¼Ÿ

---

## ğŸ“˜ ä¸€èˆ¬åŒ–å½¢å¼

è®¾æœ‰ `n` ä¸ªäººè¿‡ï¼Œè€—æ—¶åˆ†åˆ«ä¸ºï¼š

> xâ‚ < xâ‚‚ < â‹¯ < xâ‚™

æ±‚ **å…¨éƒ¨äººè¿‡æ¡¥çš„æœ€çŸ­æ€»è€—æ—¶**ã€‚

---

## âš™ï¸ åŸºæœ¬è§„å¾‹ä¸æ¨å¯¼

| ç¼–å· | è§„å¾‹æè¿° |
|:----:|:----------|
| **P1** | å»çš„æ¬¡æ•°ä¸º `n - 1` |
| **P2** | å›çš„æ¬¡æ•°ä¸º `n - 2` |
| **P3** | æ€»è¿æ¬¡ä¸º `2n - 3` |
| **P4** | è§£ç©ºé—´å¯è§†ä¸ºï¼šåœ¨å¯é‡é›† `{xâ‚, xâ‚‚, â€¦, xâ‚™}` ä¸­é€‰ `2n - 3` ä¸ªæ•°ç›¸åŠ çš„å­é›† |
| **P5** | å¤§æ•°å‡ºç°çš„æ¬¡æ•°è¶Šå°‘ï¼Œæ€»è€—æ—¶è¶Šå° |
| **P6** | æœ€æ…¢çš„äººå¿…é¡»è‡³å°‘å‚ä¸ä¸€æ¬¡è¿è¾“ |
| **P7** | æœ€æ…¢çš„ä¸¤ä¸ªäººä¸€èµ·è¿‡æ¡¥å¯èƒ½æœ€çŸ­ |
| **P8** | è€—æ—¶é•¿çš„äººä¸è¦è¿”èˆª |
| **P9** | é€’å½’è€—æ—¶æœ€é•¿çš„ä¸¤ä¸ªäººè¿‡æ¡¥æ˜¯è§£é¢˜çš„å…³é”® |

---

## ğŸ§® è¿è¾“æ–¹æ¡ˆåˆ†ç±»ï¼ˆæŒ‰æœ€æ…¢ä¸¤äººï¼‰

è®°æœ€æ…¢çš„ä¸¤äººä¸º `xâ‚™â‚‹â‚` ä¸ `xâ‚™`ã€‚

### æ–¹æ¡ˆä¸€ï¼šæœ€å¿«è€…å¸¦æœ€æ…¢ä¸¤äºº
xâ‚ å¸¦ xâ‚™ å’Œ xâ‚™â‚‹â‚

- å¾€è¿”è€—æ—¶ï¼š
`Tâ‚ = xâ‚™ + xâ‚™â‚‹â‚ + 2xâ‚`

---

### æ–¹æ¡ˆäºŒï¼šæœ€å¿«ä¸¤äººé…åˆè¿è¾“(æœ€æ…¢çš„ä¸¤ä¸ªäººä¸€èµ·è¿‡)
xâ‚ ä¸ xâ‚‚ é…åˆå¸¦äºº

- å¾€è¿”è€—æ—¶ï¼š
`Tâ‚‚ = xâ‚™ + 2xâ‚‚ + xâ‚`

---

## ğŸ§  é€’æ¨å…¬å¼æ€»ç»“

è®¾ `aâ‚–` ä¸ºå‰ `k` ä¸ªäººå…¨éƒ¨è¿‡æ¡¥çš„æœ€çŸ­æ—¶é—´ï¼š

aâ‚ = xâ‚
aâ‚‚ = xâ‚‚
aâ‚ƒ =xâ‚+xâ‚‚+xâ‚ƒ 
aâ‚™ = min( xâ‚™ + xâ‚™â‚‹â‚ + 2xâ‚ , xâ‚™ + 2xâ‚‚ + xâ‚ ) + aâ‚™â‚‹â‚‚


---

## ğŸ“ˆ ç¤ºä¾‹è®¡ç®—

ä»¥ `{1, 3, 6, 8, 12}` ä¸ºä¾‹ï¼š

aâ‚ = 1
aâ‚‚ = 3
aâ‚ƒ = 10
aâ‚„ = min(8 + 6 + 2Ã—1, 8 + 2Ã—3 + 1) + aâ‚‚ = min(16, 15) + 3 = 18
aâ‚… = min(12 + 8 + 2Ã—1, 12 + 2Ã—3 + 1) + aâ‚ƒ = min(22, 19) + 10 = 29


âœ… æœ€çŸ­æ€»è€—æ—¶ä¸º **29 åˆ†é’Ÿ**
---

## ğŸ’¡ Python åŠ¨æ€è§„åˆ’å®ç°

```python
def min_cross_time(times):
    """
    times: è¿‡æ¡¥è€—æ—¶åˆ—è¡¨ï¼ˆä¸å¿…é¢„å…ˆæ’åºï¼‰
    è¿”å›: æœ€çŸ­æ€»è€—æ—¶ï¼ˆæ•´æ•°æˆ–æµ®ç‚¹ï¼‰
    """
    if not times:
        return 0
    times = sorted(times)
    n = len(times)

    # ç›´æ¥å¤„ç†å°è§„æ¨¡çš„åŸºå‡†æƒ…å†µ
    if n == 1:
        return times[0]
    if n == 2:
        return times[1]
    if n == 3:
        return times[0] + times[1] + times[2]

    # dp[i] è¡¨ç¤ºå‰ i ä¸ªäººï¼ˆæŒ‰ä»å°åˆ°å¤§æ’åºï¼‰çš„æœ€çŸ­æ€»è€—æ—¶ï¼Œ1-based ç´¢å¼•
    dp = [0] * (n + 1)
    dp[1] = times[0]
    dp[2] = times[1]
    dp[3] = times[0] + times[1] + times[2]

    # ä» 4 å¼€å§‹ï¼Œæ¯æ¬¡æŠŠæœ€æ…¢çš„ä¸¤äººé€è¿‡å»ï¼Œé€’æ¨åˆ°å‰ i ä¸ªäºº
    for i in range(4, n + 1):
        # ä¸¤ç§å¸¸è§ç­–ç•¥ï¼ˆé’ˆå¯¹å½“å‰æœ€æ…¢çš„ä¸¤ä¸ªäºº times[i-2], times[i-1]ï¼‰
        # æ³¨æ„ï¼štimes åˆ—è¡¨ 0-basedï¼Œtimes[i-1] æ˜¯ç¬¬ i ä¸ªï¼ˆä» 1 ç®—ï¼‰çš„æ—¶é—´
        t1 = times[i - 1] + times[i - 2] + 2 * times[0]      # fastest shuttles
        t2 = times[i - 1] + 2 * times[1] + times[0]          # two fastest cooperate
        dp[i] = min(t1, t2) + dp[i - 2]

    return dp[n]


# æµ‹è¯•ç¤ºä¾‹
people = [1, 3, 6, 8, 12]
print("æœ€çŸ­æ€»è€—æ—¶:", min_cross_time(people))  # -> 29
```



---

## ğŸ’¡ Python ç©·ä¸¾å®ç°
```python
from itertools import combinations

def bridge_cross(times):
    """
    ç©·ä¸¾æ‰€æœ‰è¿‡æ²³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæœ€çŸ­è€—æ—¶ä¸è·¯å¾„
    ----------------------------------------
    å‚æ•°ï¼š
        times : dict
            æ¯ä¸ªäººçš„åå­—ä¸å¯¹åº”è¿‡æ²³è€—æ—¶ï¼Œä¾‹å¦‚ï¼š
            {'A': 1, 'B': 3, 'C': 6, 'D': 8, 'E': 12}

    è¿”å›ï¼š
        (best_time, best_path)
        best_time : æœ€çŸ­æ€»è€—æ—¶
        best_path : æœ€ä¼˜è·¯å¾„ï¼ˆå­—ç¬¦ä¸²åˆ—è¡¨ï¼‰
    """

    # åˆå§‹åŒ–å…¨å±€æœ€ä¼˜è§£
    best_time = float('inf')  # å½“å‰æœ€çŸ­è€—æ—¶
    best_path = []            # å½“å‰æœ€ä¼˜è·¯å¾„

    def dfs(left, right, boat_left, time_used, path):
        """
        æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰é€’å½’å‡½æ•°
        ----------------------------------------
        å‚æ•°ï¼š
            left : set
                å½“å‰åœ¨å·¦å²¸çš„äººé›†åˆ
            right : set
                å½“å‰åœ¨å³å²¸çš„äººé›†åˆ
            boat_left : bool
                èˆ¹æ˜¯å¦åœ¨å·¦å²¸ï¼ˆTrue è¡¨ç¤ºåœ¨å·¦å²¸ï¼‰
            time_used : int
                å½“å‰å·²ç´¯è®¡è€—æ—¶
            path : list[str]
                å½“å‰å·²æ‰§è¡Œçš„æ“ä½œåºåˆ—
        """

        nonlocal best_time, best_path  # ä¿®æ”¹å¤–å±‚å˜é‡

        # âœ… ç»ˆæ­¢æ¡ä»¶ï¼šæ‰€æœ‰äººéƒ½åˆ°å³å²¸
        if not left:
            if time_used < best_time:
                best_time = time_used
                best_path = path[:]  # å¤åˆ¶å½“å‰è·¯å¾„
            return

        # ğŸš« å‰ªæï¼šå¦‚æœå½“å‰è€—æ—¶å·²ä¸å¯èƒ½ä¼˜äºæœ€ä¼˜è§£ï¼Œæå‰è¿”å›
        if time_used >= best_time:
            return

        # ğŸš£ èˆ¹åœ¨å·¦å²¸ -> é€‰æ‹©ä¸¤äººè¿‡æ²³
        if boat_left:
            # ä»å·¦å²¸äººä¸­ä»»é€‰ä¸¤äººè¿‡æ²³ï¼ˆç»„åˆï¼‰
            for a, b in combinations(left, 2):
                # è®¡ç®—è¿‡æ²³åä¸¤å²¸äººå‘˜å˜åŒ–
                new_left = left - {a, b}
                new_right = right | {a, b}
                cost = max(times[a], times[b])  # è¿‡æ²³è€—æ—¶å–è¾ƒæ…¢è€…
                # é€’å½’æœç´¢ä¸‹ä¸€æ­¥ï¼ˆèˆ¹åˆ°äº†å³å²¸ï¼‰
                dfs(
                    new_left,
                    new_right,
                    False,  # èˆ¹ç°åœ¨åœ¨å³å²¸
                    time_used + cost,
                    path + [f"{a},{b} -> ({cost})"]
                )

        # â›µ èˆ¹åœ¨å³å²¸ -> é€‰æ‹©ä¸€äººè¿”å›
        else:
            for a in right:
                # è¿”å›è€…å›åˆ°å·¦å²¸
                new_left = left | {a}
                new_right = right - {a}
                cost = times[a]  # è¿”å›è€—æ—¶ä¸ºè¯¥äººæ—¶é—´
                dfs(
                    new_left,
                    new_right,
                    True,  # èˆ¹å›åˆ°å·¦å²¸
                    time_used + cost,
                    path + [f"<- {a} ({cost})"]
                )

    # ğŸš€ åˆå§‹åŒ–æœç´¢
    names = set(times.keys())  # æ‰€æœ‰äººåˆå§‹åœ¨å·¦å²¸
    dfs(names, set(), True, 0, [])

    return best_time, best_path


# ===================== ç¤ºä¾‹è¿è¡Œ =====================

people = {'A': 1, 'B': 3, 'C': 6, 'D': 8, 'E': 12}

best_time, best_path = bridge_cross(people)

print("æœ€çŸ­æ€»è€—æ—¶:", best_time)
print("æœ€ä¼˜æ–¹æ¡ˆ:")
for step in best_path:
    print("  ", step)

"""
æ‰“å°ï¼š
æœ€çŸ­æ€»è€—æ—¶: 29
æœ€ä¼˜æ–¹æ¡ˆ:
   B,A -> (3)
   <- B (3)
   E,D -> (12)
   <- A (1)
   C,A -> (6)
   <- A (1)
   B,A -> (3)

"""

```