# 容斥定理
参考 [集合符](https://blog.csdn.net/qq_26074053/article/details/152092173) 

 $$\left|\bigcup_{i=1}^{n} A_{i}\right|=\sum_{i=1}^{n}(-1)^{i-1} A_{[i]}$$
$$
\left| \bigcup_{i=1}^n A_i \right|
= \sum_{i=1}^{n} (-1)^{i-1} \sum_{1 \le k_1 < \dots < k_i \le n} |A_{k_1} \cap \dots \cap A_{k_i}|
$$

这里证法应该是最简单、最直接的证法，而数学归纳法的缺点是必须先猜出答案。

![](https://i-blog.csdnimg.cn/img_convert/e6ab203f4fd56f45c288d6642ac6c271.jpeg)

# 约定
$A_{[i]}$ 与 $A_{(i)}$ 表示集合或者对应的基数，具体由上下文决定。
- 约定1：$A = \{ A_{1}, A_{2}, \dots, A_{n} \}$
- 约定2：$A_{[i]} :=$ A 中所有 $i$ 个元素交的模的和，或 A 中所有 $i$ 个元素的交簇。
- 约定3：$A_{(i)} :=$ A 中所有仅有 $i$ 个元素交的模的和，或 A 中仅有 $i$ 个元素的交，$A_{(i)}$的元素称作i重元
- 约定4：$\mathcal{A} = \bigcup_{i=1}^{n} A_{i} = \bigcup_{i=1}^{n} A_{(i)}$  ，是样本空间
  其中 $A_{(1)}$...  $A_{(n)}$是 $\mathcal{A}$ 的一个划分，若 i ≠j 则 $A_{(i)}$ 和 $A_{(j)}$的元素无交集。
- 约定5：$tA_{(k)}$ 指 $A_{(k)}$ 中的元素算了 $t$ 次（$t \geq 0$）。

---

## T1
$A_{[k]}$ 对 $A_{(s)}$ 中的元素算了 $C_{s}^{k}$ 次（$s > k$）。

**P1：**  
$x \in A_{(s)}$，则 $x$ 被确定的 $s$ 个集合包含。  
从这 $s$ 个集合挑出 $k$ 个集合对应到 $A_{[k]}$ 上，每一种挑法 $x$ 都被算 1 次。

例如：  
- $A_{[5]}$ 对 $A_{(3)}$ 算了 0 次。  
- 因为 $A_{[5]}$ 中的元素至少是 5 个集合交出来的(也可能是大于5个集合交出的)  
- 而 $A_{(3)}$ 中的元素是 3 个集合交出来的。  
- 所以 $x \in A_{(3)} \Rightarrow x \notin A_{[5]}$。

---

## $A_{[i]}$ 与 $A_{(i)}$ 的关系
- $A_{[1]} : \quad C_{1}^{1} A_{(1)} \;+\; C_{2}^{1} A_{(2)} \;+\; \dots \;+\; C_{n}^{1} A_{(n)}$  
- $A_{[2]} : \quad 0A_{(1)} \;+\; C_{2}^{2} A_{(2)} \;+\; \dots \;+\; C_{n}^{2} A_{(n)}$  
- $\dots$  
- $A_{[n]} : \quad 0A_{(1)} \;+\; 0A_{(2)} \;+\; \dots \;+\; C_{n}^{n} A_{(n)}$

取第 1 行 - 第 2 行 + 第 3 行 - ... + 第 n 行，即得到：

$$
A_{(1)} + A_{(2)} + \dots + A_{(n)}
$$
这正是总的样本空间的元素个数

---


## 解释  
这里$A_{[i]}$ 与 $A_{(i)}$ 表示对应集合的基数, 即 用集合指代集合的基数
上面用到了恒等式
$$\sum_{i=1}^{n} (-1)^{i-1} C_{n}^{i} = 1$$  
故
$$\left|\bigcup_{i=1}^{n} A_{i}\right| = A_{(1)} + A_{(2)} + \dots + A_{(n)} = A_{[1]} - A_{[2]} + A_{[3]} - \dots + A_{[n]}$$
即
 $$\left|\bigcup_{i=1}^{n} A_{i}\right|=\sum_{i=1}^{n}(-1)^{i-1} A_{[i]}$$